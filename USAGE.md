# Q槽文件智能助手使用指南

## 系統概述

Q槽文件智能助手是一個基於RAG（檢索增強生成）技術的智能問答系統，專門用於檢索和查詢公司遠端Q槽上的文件。系統可以自動爬取Q槽文件，建立索引，並支持用戶通過自然語言提問來獲取文檔中的信息。

## 系統架構

系統由以下幾個主要組件構成：

1. **文件索引系統**：爬取Q槽文件並建立向量索引
2. **RAG查詢引擎**：處理用戶問題並檢索相關文檔
3. **後端API**：提供RESTful服務接口
4. **前端界面**：用戶與系統交互的網頁界面

## 安裝部署

### 系統需求

- Python 3.9+
- 網絡訪問權限（用於連接Q槽）

### 安裝步驟

1. **安裝依賴**：

   ```
   pip install -r requirements.txt
   ```
2. **配置環境變量**：

   - 複製 `.env.example`為 `.env`
   - 編輯 `.env`文件，填寫以下關鍵信息：
     - `Q_DRIVE_PATH`：Q槽的路徑
     - 其他可選配置項

## 使用方法

### 初始化索引

首次使用前，需要建立文檔索引：

```
.\venv\Scripts\python.exe scripts/initial_indexing.py
```

此過程會爬取Q槽上的所有支持格式的文件，並建立索引。根據文件數量和大小，此過程可能需要一些時間。

### 啟動服務

啟動API服務和前端界面：

1. **啟動API服務**：

   ```
   .\venv\Scripts\python.exe api/main.py
   ```

   服務將在默認端口（8000）啟動，可以通過 `--port`參數指定其他端口。
2. **啟動前端界面**：

   ```
   .\venv\Scripts\python.exe -m streamlit run frontend/streamlit_app.py
   ```

   前端界面將在默認端口（8501）啟動，可以通過瀏覽器訪問：http://localhost:8501

### 文件監控

系統提供文件變更監控功能，可以自動更新索引：

```
.\venv\Scripts\python.exe scripts/monitor_changes.py
```

默認每小時檢查一次文件變更，可以通過 `--interval`參數調整檢查間隔（單位：秒）。

### 重新索引

如需完全重建索引，可以使用以下命令：

```
.\venv\Scripts\python.exe scripts/reindex.py
```

此命令會清除現有索引並重新建立。

## 使用示例

1. **訪問前端界面**：打開瀏覽器訪問 http://localhost:8501
2. **提問**：在輸入框中輸入您的問題，例如：

   - "公司的年假政策是什麼？"
   - "如何申請報銷差旅費？"
   - "產品退貨流程是怎樣的？"
3. **查看回答**：系統會搜索相關文檔並給出回答，同時顯示參考來源

## 故障排除

- **無法訪問Q槽**：確保Q槽已正確掛載，並且運行程序的用戶有訪問權限
- **索引失敗**：檢查 `.env`文件中的Q槽路徑配置是否正確
- **API服務無法啟動**：檢查端口是否被占用，可使用 `--port`參數更改端口

## 支持的文件格式

系統支持以下文件格式：

- PDF文件 (.pdf)
- Word文檔 (.docx)
- Excel表格 (.xlsx)
- 文本文件 (.txt)
- Markdown文件 (.md)
- PowerPoint演示文稿 (.pptx)
- CSV文件 (.csv)

## 高級功能

### 自定義配置

可以通過編輯 `config/config.py`或 `.env`文件來調整系統配置：

- 修改支持的文件類型
- 調整文本分割參數
- 配置檢索結果數量

### API接口

系統提供RESTful API接口，可以集成到其他應用中：

- **健康檢查**: `GET /health`
- **系統狀態**: `GET /`
- **問答接口**: `POST /ask`

API文檔可通過訪問 http://localhost:8000/docs 獲取更多詳細信息。
